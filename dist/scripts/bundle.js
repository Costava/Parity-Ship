!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function s(){if(p.newTime=(new Date).getTime(),p.dt=p.newTime-p.oldTime,p.gameTime+=p.dt,p.tasks.forEach(function(t){p.gameTime>=t.time&&(t.callback(),p.tasks.splice(p.tasks.indexOf(t),1))}),p.gameTime-p.newShipTime>p.newShipInterval){var t=Math.random()*(3+p.maxShipRadius)+100,e=Math.max(0-p.minShipRadius,p.player.pos.y-.7*p.maxY()),i=Math.min(p.maxY()+p.minShipRadius,p.player.pos.y+.7*p.maxY()),l=Math.random()*(i-e)+e,d=n.randomInInterval(p.minShipRadius,p.maxShipRadius),m=n.randomInInterval(.3,1.2)*d,f=n.randomInInterval(p.minShipSpeed,p.maxShipSpeed);f*=-1;var g=new c({x:t,y:l},d,m,r.random(n.randomInInterval(.7,.9)),{x:f,y:0});p.ships.push(g),p.newShipTime=p.gameTime}if(p.gameTime-p.newPlanetTime>p.newPlanetInterval){var t=Math.random()*(3+p.maxPlanetLength)+100,l=Math.random()*p.maxY(),m=n.randomInInterval(p.minPlanetLength,p.maxPlanetLength),v=r.random(1),y=.25;v.r*=y,v.g*=y,v.b*=y;var f=.001*m;f*=-1;var S=new u({x:t,y:l},m,v,{x:f,y:0});p.planets.push(S),p.newPlanetTime=p.gameTime}p.player.move(p.dt),p.mousedown&&p.tryShoot({x:p.player.pos.x,y:p.player.pos.y}),p.planets.forEach(function(t){var e=t.speed.x*p.dt,i=t.speed.y*p.dt;t.pos.x+=e,t.pos.y+=i}),p.ships.forEach(function(t){var e=t.speed.x*p.dt,i=t.speed.y*p.dt;t.pos.x+=e,t.pos.y+=i}),p.cleanPackets.forEach(function(t){var e=t.speed.x*p.dt,i=t.speed.y*p.dt;t.pos.x+=e,t.pos.y+=i}),p.ships.forEach(function(t){(t.pos.x<0||t.pos.x>100&&t.hit)&&p.ships.splice(p.ships.indexOf(t),1)}),p.planets.forEach(function(t){t.pos.x<0-t.sideLength&&p.planets.splice(p.planets.indexOf(t),1)}),p.cleanPackets.forEach(function(t){t.pos.x>100&&p.cleanPackets.splice(p.cleanPackets.indexOf(t),1)}),p.cleanPackets.forEach(function(t){t.hit||p.ships.some(function(e){if(!e.hit){var i=o.distance(t.pos,e.pos),s=t.radius+e.radius;if(s>i){e.hit=!0,e.speed.x*=-1.1,setTimeout(function(){e.speed.x*=1.8},150),t.hit=!0,t.speed.x*=.3;var n=new h(t.color.clone(),new r(0,0,0,0),p.cpFadeTime,t);n.callback=function(t,e){return function(){p.colorChangers.splice(p.colorChangers.indexOf(t),1),p.cleanPackets.splice(p.cleanPackets.indexOf(e),1)}}(n,t),p.colorChangers.push(n);var c=new a(p.player,e,2.5,e.innerColor.clone()),u=new r((e.innerColor.r+255)/2,(e.innerColor.g+255)/2,(e.innerColor.b+255)/2,0),l=new h(e.innerColor.clone(),u,p.fadeBarTime,c);l.callback=function(t,e){return function(){p.colorChangers.splice(p.colorChangers.indexOf(t),1),p.fadeBars.splice(p.fadeBars.indexOf(e),1)}}(l,c),p.fadeBars.push(c),p.colorChangers.push(l);var d=new h(p.player.color.clone(),e.innerColor.clone(),p.fadeBarTime,p.player);return d.callback=function(t){return function(){p.colorChangers.splice(p.colorChangers.indexOf(t),1)}}(d),p.colorChangers.push(d),p.score+=1,!0}}})}),p.ships.some(function(t){var e=o.distance(p.player.pos,t.pos),i=p.player.radius+t.radius;return i>e?(p.endGameCleanUp(),p.score>p.highScore?(p.highScore=p.score,document.querySelector(".js-new").innerHTML="New&nbsp;"):document.querySelector(".js-new").innerHTML="",document.querySelector(".js-score").innerHTML=p.score,document.querySelector(".js-high-score").innerHTML=p.highScore,document.querySelector(".js-game-canvas").style["background-color"]="rgba(220, 14, 16, 1)",setTimeout(function(){document.querySelector(".js-game-canvas").style["background-color"]="#000",p.changeMenu(p.menus.end)},1500),!0):void 0}),p.colorChangers.forEach(function(t){t.change(p.dt)}),p.player.innerColor=p.player.color.inverse(),p.draw(),p.oldTime=p.newTime,p.looping&&window.requestAnimationFrame(s)}console.log("main.js");var n=i(2),o=i(5),r=i(1),h=i(6),a=i(7),c=(i(4),i(10)),u=(i(3),i(9)),l=i(8),p=new l;p.loop=s,["main","about","pause","end"].forEach(function(t){p.menus[t]=document.querySelector(".js-"+t+"-menu")}),document.querySelector(".js-play-button").addEventListener("click",function(){p.startGame()}),document.querySelector(".js-about-button").addEventListener("click",function(){p.changeMenu(p.menus.about)}),document.querySelector(".js-back-button").addEventListener("click",function(){p.changeMenu(p.menus.main)}),document.querySelector(".js-again-button").addEventListener("click",function(){p.startGame()}),document.querySelector(".js-return-button").addEventListener("click",function(){p.changeMenu(p.menus.main)}),document.querySelector(".js-resume-button").addEventListener("click",function(){p.resume()}),document.querySelector(".js-quit-button").addEventListener("click",function(){p.endGameCleanUp(),p.changeMenu(p.menus.main)}),p.changeMenu(p.menus.main)},function(t,e,i){"use strict";function s(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}var n=i(2);s.random=function(t){var e,i=n.randomInt(0,255),o=n.randomInt(0,255),r=n.randomInt(0,255);return e="number"==typeof t?t:1,new s(i,o,r,e)},s.prototype.toString=function(t){return t?"rgb("+this.r+", "+this.g+", "+this.b+")":"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a+")"},s.prototype.floored=function(t){var e=new s(Math.floor(this.r),Math.floor(this.g),Math.floor(this.b),this.a);return t&&(e.a=Math.floor(e.a)),e},s.prototype.inverse=function(t){return t?new s(255-this.r,255-this.g,255-this.b,1-this.a):new s(255-this.r,255-this.g,255-this.b,this.a)},s.prototype.invert=function(t){this.r=255-this.r,this.g=255-this.g,this.b=255-this.b,t&&(this.a=1-this.a)},s.prototype.clamp=function(){["r","g","b"].forEach(function(t,e,i){this[t]=Math.max(Math.min(this[t],255),0)}.bind(this)),this.a=Math.max(Math.min(this.a,1),0)},s.prototype.clone=function(){return new s(this.r,this.g,this.b,this.a)},t.exports=s},function(t,e){"use strict";var i={};i.randomInt=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},i.randomInInterval=function(t,e){return Math.random()*(e-t)+t},i.maxChildSize=function(t,e,i){var s,n,o=e/i;return t==o?(s=e,n=i):o>t?(n=i,s=n*t):t>o&&(s=e,n=s/t),{width:s,height:n}},t.exports=i},function(t,e,i){"use strict";function s(t){this.pos=t,this.radius=1.8,this.speed={x:.06,y:0},this.color=new n(240,70,96,.9),this.hit=!1}var n=i(1);s.prototype.draw=function(t){t.save(),t.translate(this.pos.x,this.pos.y),this._draw(t),t.restore()},s.prototype._draw=function(t){t.save(),t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI,!1),t.fillStyle=this.color.floored().toString(),t.fill(),t.restore()},t.exports=s},function(t,e,i){"use strict";function s(){this.pos={},this.pos.x=10,this.pos.y=28.125,this.targetPos={},this.targetPos.x=this.pos.x,this.targetPos.y=this.pos.y,this.speed=.5,this.radius=5,this.sideLength=3,this.color=new n(255,255,255,1),this.innerColor=this.color.inverse(),this.hits=0}var n=i(1);s.prototype.move=function(t){var e=this.speed*t;["x","y"].forEach(function(t){var i=this.targetPos[t]-this.pos[t];e>=Math.abs(i)?this.pos[t]=this.targetPos[t]:this.pos[t]+=e*(Math.abs(i)/i)}.bind(this))},s.prototype.draw=function(t){t.save(),t.translate(this.pos.x,this.pos.y),this._draw(t),t.restore()},s.prototype._draw=function(t){t.save(),t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI,!1),t.fillStyle=this.color.floored().toString(),t.fill(),t.closePath(),t.beginPath();var e=this.sideLength/2*Math.sqrt(3)/2;t.moveTo(-e,-this.sideLength/2),t.lineTo(e,0),t.lineTo(-e,this.sideLength/2),t.fillStyle=this.innerColor.floored().toString(),t.fill(),t.closePath(),t.restore()},t.exports=s},function(t,e){"use strict";var i={};i.distance=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},i.magnitude=function(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))},i.rotate=function(t,e){var s=Math.atan2(t.y,t.x);s+=e;var n=Math.cos(s),o=Math.sin(s),r=i.magnitude(t);return{x:n*r,y:o*r}},t.exports=i},function(t,e){"use strict";function i(t,e,i,s){this.initColor=t,this.finalColor=e;var n=this;["r","g","b","a"].forEach(function(s,o,r){n["d"+s]=(e[s]-t[s])/i}),this.totalTime=i,this.timeLeft=this.totalTime,this.target=s,this.callback=function(){console.log("Done")}}i.prototype.change=function(t){if(this.timeLeft>0){var e=Math.min(t,this.timeLeft),i=this;["r","g","b","a"].forEach(function(t){i.target.color[t]+=i["d"+t]*e}),this.target.color.clamp(),t<this.timeLeft?this.timeLeft-=t:(this.timeLeft=0,this.callback())}},t.exports=i},function(t,e){"use strict";function i(t,e,i,s){this.obj1=t,this.obj2=e,this.width=i,this.color=s}i.prototype.draw=function(t){t.save(),t.beginPath(),t.moveTo(this.obj1.pos.x,this.obj1.pos.y),t.lineTo(this.obj2.pos.x,this.obj2.pos.y),t.lineWidth=this.width,t.strokeStyle=this.color.floored().toString(),t.stroke(),t.restore()},t.exports=i},function(t,e,i){"use strict";function s(){this.aspectRatioWidth=16,this.aspectRatioHeight=9,this.menus={},this.currentMenu,this.menuShowDuration="0.5s",this.menuHideDuration="0.2s",this.sideShootInterval=200,this.sideShootTime=0,this.centerShootInterval=400,this.centerShootTime=0,this.shootSideAngle=Math.PI/7,this.newShipIntervalInitial=400,this.newShipIntervalFinal=46,this.newShipInterval=this.newShipIntervalInitial,this.newShipTime=0,this.newShipIntervalDiff=50,this.newShipIncrementInterval=4e3,this.fadeBarTime=800,this.cpFadeTime=300,this.minShipSpeed=.03,this.maxShipSpeed=.09,this.shipBotSpeed=this.minShipSpeed,this.shipTopSpeed=this.maxShipSpeed,this.speedInterval=.01,this.speedIncrementInterval=4e3,this.minShipRadius=2,this.maxShipRadius=5,this.newPlanetInterval=300,this.newPlanetTime=0,this.minPlanetLength=3,this.maxPlanetLength=15,this.highScore=0,this.tasks=[],this.oldTime=0,this.newTime=0,this.gameTime=0,this.playBackgroundColor="rgba(91, 112, 179, 1)",this.menuBackgroundColor="#000",this.paused=!1,this.resuming=!1,this.inProgress=!1,this.loop=function(){console.log("Default loop call")},this.EventPos=function(t){var e={};return e.x=t.clientX-this.canvas.offsetLeft,e.y=t.clientY-this.canvas.offsetTop,e.x=e.x/this.vh,e.y=e.y/this.vh,e},this.mousedown=!1,this.TrackMousePos=function(t){var e=this.EventPos(t);this.isVhPosOnCanvas(e)&&(this.player.targetPos=e)}.bind(this),this.ShootListener=function(t){if(0===t.button){var e=this.EventPos(t);this.tryShoot(e)}}.bind(this),this.PauseListener=function(t){return t.preventDefault(),this.tryTogglePause(),!1}.bind(this),this.TrackLeftMouseDown=function(t){0===t.button&&(this.mousedown=!0)}.bind(this),this.TrackLeftMouseUp=function(t){0===t.button&&(this.mousedown=!1)}.bind(this)}var n=i(2),o=i(4),r=i(3),h=i(5),a=i(11);s.prototype.bindControls=function(t){t.addEventListener("mousemove",this.TrackMousePos),t.addEventListener("click",this.ShootListener),t.addEventListener("contextmenu",this.PauseListener),t.addEventListener("mousedown",this.TrackLeftMouseDown),t.addEventListener("mouseup",this.TrackLeftMouseUp)},s.prototype.unbindControls=function(t){t.removeEventListener("mousemove",this.TrackMousePos),t.removeEventListener("click",this.ShootListener),t.removeEventListener("contextmenu",this.PauseListener),t.removeEventListener("mousedown",this.TrackLeftMouseDown),t.removeEventListener("mouseup",this.TrackLeftMouseUp)},s.prototype.hideMenu=function(t){for(var e=t.querySelectorAll(".js-menu-button"),i=0;i<e.length;i++)e[i].disabled=!0;t.style["transition-duration"]=this.menuHideDuration,t.style.top="-100%",t.style.bottom="100%"},s.prototype.showMenu=function(t){for(var e=t.querySelectorAll(".js-menu-button"),i=0;i<e.length;i++)e[i].disabled=!1;t.style["transition-duration"]=this.menuShowDuration,t.style.top="0",t.style.bottom="0"},s.prototype.changeMenu=function(t){void 0!=this.currentMenu&&this.hideMenu(this.currentMenu),void 0!=t&&(this.showMenu(t),this.currentMenu=t)},s.prototype.aspectRatio=function(){return this.aspectRatioWidth/this.aspectRatioHeight},s.prototype.maxY=function(){return this.canvas.height/this.vh},s.prototype.isVhPosOnCanvas=function(t){return t.x>=0&&t.x<=100&&t.y>=0&&t.y<=this.maxY()?!0:!1},s.prototype.tryShoot=function(t){if(this.gameTime-this.sideShootTime>=this.sideShootInterval){var e=new r({x:t.x,y:t.y}),i=new r({x:t.x,y:t.y});e.speed=h.rotate(e.speed,this.shootSideAngle),i.speed=h.rotate(i.speed,-this.shootSideAngle),this.cleanPackets.push(e),this.cleanPackets.push(i),this.sideShootTime=this.gameTime}if(this.gameTime-this.centerShootTime>=this.centerShootInterval){var s=new r({x:t.x,y:t.y});this.cleanPackets.push(s),this.centerShootTime=this.gameTime}},s.prototype._draw=function(t){t.save(),t.clearRect(0,0,this.canvas.width,this.canvas.height),t.scale(this.vh,this.vh),this.planets.forEach(function(e){e.draw(t,this.planetBlur)}.bind(this)),this.cleanPackets.forEach(function(e){e.draw(t)}.bind(this)),this.fadeBars.forEach(function(e){e.draw(t)}.bind(this)),this.player.draw(t),this.ships.forEach(function(e){e.draw(t)}.bind(this)),t.restore()},s.prototype.draw=function(){this._draw(this.ctx)},s.prototype.startGame=function(){console.log("Game start"),this.paused=!1,this.resuming=!1,this.inProgress=!0,this.mousedown=!1,this.changeMenu(),document.querySelector(".game-container").style["background-color"]=this.playBackgroundColor,this.player=new o,this.ships=[],this.cleanPackets=[],this.corrPackets=[],this.colorChangers=[],this.fadeBars=[],this.planets=[],this.tasks=[],this.blurCheckbox=document.querySelector(".js-planet-blur"),this.planetBlur=this.blurCheckbox.checked,this.score=0,this.canvas=document.createElement("canvas"),this.canvas.className="game-canvas js-game-canvas",this.canvasCont=document.querySelector(".js-canvas-container");var t=n.maxChildSize(this.aspectRatio(),this.canvasCont.offsetWidth,this.canvasCont.offsetHeight);t.width=Math.ceil(t.width),t.height=Math.ceil(t.height),this.canvas.style.width=t.width,this.canvas.style.height=t.height,this.canvas.width=t.width,this.canvas.height=t.height,this.ctx=this.canvas.getContext("2d"),this.canvasCont.innerHTML="",this.canvasCont.appendChild(this.canvas),this.vh=this.canvas.width/100;var e=Math.floor((this.shipTopSpeed-this.shipBotSpeed)/this.speedInterval);this.minShipSpeed=this.shipBotSpeed,this.maxShipSpeed=this.minShipSpeed+this.speedInterval;for(var i=0;e>i;i++){var s=(i+1)*this.speedIncrementInterval,r=function(t){return function(){this.minShipSpeed=this.shipBotSpeed+(t+1)*this.speedInterval,this.maxShipSpeed=this.minShipSpeed+this.speedInterval}}(i).bind(this),h=new a(s,r);this.tasks.push(h)}var s=(e+1)*this.speedIncrementInterval,r=function(){this.maxShipSpeed=this.shipTopSpeed,this.minShipSpeed=this.maxShipSpeed-this.speedInterval}.bind(this),h=new a(s,r);this.tasks.push(h),e=Math.floor((this.newShipIntervalInitial-this.newShipIntervalFinal)/this.newShipIntervalDiff),this.newShipInterval=this.newShipIntervalInitial;for(var i=0;e>i;i++){var s=(i+1)*this.newShipIncrementInterval,r=function(t){return function(){this.newShipInterval=this.newShipIntervalInitial-(t+1)*this.newShipIntervalDiff}}(i).bind(this),h=new a(s,r);this.tasks.push(h)}var s=(e+1)*this.newShipIncrementInterval,r=function(){this.newShipInterval=this.newShipIntervalFinal}.bind(this),h=new a(s,r);this.tasks.push(h);var c=(new Date).getTime();this.oldTime=c,this.gameTime=0,this.newShipTime=this.gameTime-this.newShipInterval,this.newPlanetTime=this.gameTime-this.newPlanetInterval,this.sideShootTime=this.gameTime+100,this.centerShootTime=this.gameTime+100,this.bindControls(document),this.looping=!0,this.loop()},s.prototype.pauseAction=function(){document.querySelector(".game-container").style["background-color"]=this.menuBackgroundColor,this.canvas.style.transform="scale(0.8, 0.8)"},s.prototype.resumeAction=function(){document.querySelector(".game-container").style["background-color"]=this.playBackgroundColor,this.canvas.style.transform="scale(1, 1)"},s.prototype.pause=function(){this.looping=!1,this.paused=!0,this.resuming=!1,this.pauseAction(),document.querySelector(".js-pause-score").innerHTML=this.score,this.changeMenu(this.menus.pause)},s.prototype.resume=function(){this.resuming=!0,this.changeMenu(),this.resumeAction(),setTimeout(function(){var t=(new Date).getTime();this.oldTime=t,this.paused=!1,this.resuming=!1,this.looping=!0,this.loop()}.bind(this),800)},s.prototype.tryTogglePause=function(){this.inProgress&&(this.paused&&!this.resuming?this.resume():this.paused||this.resuming||this.pause())},s.prototype.endGameCleanUp=function(){console.log("Game end"),this.inProgress=!1,this.looping=!1,this.paused=!1,this.resuming=!1,this.unbindControls(document),document.querySelector(".game-container").style["background-color"]=this.menuBackgroundColor},t.exports=s},function(t,e){"use strict";function i(t,e,i,s){this.pos=t,this.sideLength=e,this.color=i,this.speed=s}i.prototype.draw=function(t,e){t.save(),t.fillStyle=this.color.floored().toString(),e&&(t.shadowColor=this.color.floored().toString(),t.shadowBlur=4*this.sideLength),t.fillRect(this.pos.x,this.pos.y,this.sideLength,this.sideLength),t.restore()},t.exports=i},function(t,e){"use strict";function i(t,e,i,s,n){this.pos=t,this.radius=e,this.sideLength=i,this.outerColor=s,this.innerColor=s.inverse(),this.innerColor.a=1,this.speed=n,this.hit=!1}i.prototype.draw=function(t){t.save(),t.translate(this.pos.x,this.pos.y),this._draw(t),t.restore()},i.prototype._draw=function(t){t.save(),t.beginPath(),t.arc(0,0,this.radius,0,2*Math.PI,!1),t.fillStyle=this.outerColor.toString(),t.fill(),t.closePath(),t.beginPath(),t.rect(-this.sideLength/2,-this.sideLength/2,this.sideLength,this.sideLength),t.fillStyle=this.innerColor.toString(),t.fill(),t.closePath(),t.restore()},t.exports=i},function(t,e){"use strict";function i(t,e){this.time=t,this.callback=e}t.exports=i}]);